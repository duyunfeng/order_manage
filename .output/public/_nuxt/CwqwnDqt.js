import{d as S,am as B,an as I,ao as C,h as l,a as N,r as q,u as _,a1 as E,e as F,ap as z,aq as H,ar as P,as as R,at as T,au as O,av as M,aw as U,ax as V,ay as W,az as D,aA as G,P as J}from"./BxW7P6YO.js";const L=(a="RouteProvider")=>S({name:a,props:{vnode:{type:Object,required:!0},route:{type:Object,required:!0},vnodeRef:Object,renderKey:String,trackRootNodes:Boolean},setup(o){const t=o.renderKey,s=o.route,n={};for(const r in o.route)Object.defineProperty(n,r,{get:()=>t===o.renderKey?o.route[r]:s[r],enumerable:!0});return B(C,I(n)),()=>l(o.vnode,{ref:o.vnodeRef})}}),Q=L(),j=new WeakMap,te=S({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(a,{attrs:o,slots:t,expose:s}){const n=N(),r=q(),i=H(C,null);let c;s({pageRef:r});const u=H(P,null);let d;const y=n.deferHydration();if(n.isHydrating){const e=n.hooks.hookOnce("app:error",y);_().beforeEach(e)}a.pageKey&&E(()=>a.pageKey,(e,m)=>{e!==m&&n.callHook("page:loading:start")});let f=!1;{const e=_().beforeResolve(()=>{f=!1});F(()=>{e()})}return()=>l(z,{name:a.name,route:a.route,...o},{default:e=>{const m=Y(i,e.route,e.Component),k=i&&i.matched.length===e.route.matched.length;if(!e.Component){if(d&&!k)return d;y();return}if(d&&u&&!u.isCurrent(e.route))return d;if(m&&i&&(!u||u!=null&&u.isCurrent(i)))return k?d:null;const g=R(e,a.pageKey),b=Z(i,e.route,e.Component);!n.isHydrating&&c===g&&!b&&T(()=>{f=!0,n.callHook("page:loading:end")}),c=g;const h=!!(a.transition??e.route.meta.pageTransition??O),w=h&&X([a.transition,e.route.meta.pageTransition,O,{onBeforeLeave(){n._runningTransition=!0},onAfterLeave(){delete n._runningTransition,n.callHook("page:transition:finish",e.Component)}}]),K=a.keepalive??e.route.meta.keepalive??M;return d=U(h&&w,V(K,l(W,{suspensible:!0,onPending:()=>n.callHook("page:start",e.Component),onResolve:()=>{T(()=>n.callHook("page:finish",e.Component).then(()=>{if(!f&&!b)return f=!0,n.callHook("page:loading:end")}).finally(y))}},{default:()=>{const x={key:g||void 0,vnode:t.default?$(t.default,e):e.Component,route:e.route,renderKey:g||void 0,trackRootNodes:h,vnodeRef:r};if(!K)return l(Q,x);const p=e.Component.type,A=p;let v=j.get(A);return v||(v=L(p.name||p.__name),j.set(A,v)),l(v,x)}}))).default(),d}})}});function X(a){const o=a.filter(Boolean).map(t=>({...t,onAfterLeave:t.onAfterLeave?D(t.onAfterLeave):void 0}));return G(...o)}function Y(a,o,t){if(!a)return!1;const s=o.matched.findIndex(n=>{var r;return((r=n.components)==null?void 0:r.default)===(t==null?void 0:t.type)});return!s||s===-1?!1:o.matched.slice(0,s).some((n,r)=>{var i,c,u;return((i=n.components)==null?void 0:i.default)!==((u=(c=a.matched[r])==null?void 0:c.components)==null?void 0:u.default)})||t&&R({route:o,Component:t})!==R({route:a,Component:t})}function Z(a,o,t){return a?o.matched.findIndex(n=>{var r;return((r=n.components)==null?void 0:r.default)===(t==null?void 0:t.type)})<o.matched.length-1:!1}function $(a,o){const t=a(o);return t.length===1?l(t[0]):l(J,void 0,t)}export{te as _};

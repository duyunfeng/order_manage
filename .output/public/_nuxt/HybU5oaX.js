import{a as c,d as q,r as p,o as I,G as N,D as s,g as D,z as T,A as B,C as i,E as v,B as z,R as M,_ as R}from"./BxW7P6YO.js";import{B as U,a as j}from"./DmTcGZZt.js";import{B as G}from"./32st1eI5.js";import{B as L}from"./DTLkWoKO.js";function W(n){const{$axios:l}=c();return l.get("/factories",{params:n})}function H(n){const{$axios:l}=c();return l.post("/factories",n)}function J(n,l){const{$axios:r}=c();return delete l._id,r.put(`/factories/${n}`,l)}function K(n){const{$axios:l}=c();return l.delete(`/factories/${n}`)}const O={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-bottom":"16px"}},P=q({__name:"index",setup(n){const l={active:"正常",inactive:"停用"},r=p({id:"",name:"",status:""}),w=[{prop:"id",label:"工厂ID",placeholder:"请输入工厂ID",type:"input"},{prop:"name",label:"工厂名称",placeholder:"请输入工厂名称",type:"input"},{prop:"status",label:"状态",type:"select",placeholder:"请选择状态",options:[{label:"全部",value:""},{label:"正常",value:"active"},{label:"停用",value:"inactive"}]}],d=p(!1),m=p(!1),b=p({name:"",address:"",manager:"",phone:"",status:"正常",_id:void 0}),C=[{prop:"name",label:"工厂名称",type:"input",placeholder:"请输入工厂名称",required:!0},{prop:"address",label:"地址",type:"input",placeholder:"请输入地址",required:!0},{prop:"manager",label:"负责人",type:"input",placeholder:"请输入负责人",required:!0},{prop:"phone",label:"联系方式",type:"input",placeholder:"请输入联系方式",required:!0},{prop:"status",label:"状态",type:"select",placeholder:"请选择状态",options:[{label:"正常",value:"active"},{label:"停用",value:"inactive"}],required:!0}],F=[{prop:"id",label:"工厂ID",width:200},{prop:"name",label:"工厂名称",width:120},{prop:"address",label:"地址",width:200},{prop:"manager",label:"负责人",width:120},{prop:"phone",label:"联系方式",width:140},{prop:"status",label:"状态",width:100,slot:!0},{prop:"createdAt",label:"创建时间",width:160},{prop:"updatedAt",label:"更新时间",width:160},{prop:"actions",label:"操作",minWidth:180,slot:!0,actions:G,getActions:(t,e)=>[{label:"编辑",type:"primary",onClick:o=>_(o)},{label:"删除",type:"danger",onClick:o=>g(o)}]}],f=p([]),{$axios:Q}=c();I(u);async function u(){const t=await W(r.value);f.value=t.data.data||t}function $(t){u().then(()=>{f.value=f.value.filter(e=>{const o=!t.id||e.id.includes(t.id),h=!t.name||e.name.includes(t.name),x=!t.status||e.status===t.status;return o&&h&&x})})}function k(){r.value={id:"",name:"",status:""},u()}function V(){m.value=!1,y(),d.value=!0}function A(t){m.value=!0,b.value={...t,_id:t.id},d.value=!0}function y(){b.value={name:"",address:"",manager:"",phone:"",status:"正常",_id:void 0}}async function E(t){const e={...t};delete e._id,m.value?await J(t._id,e):await H(e),u(),d.value=!1,y()}function _(t){A(t)}function g(t){M.confirm(`确定要删除工厂：${t.name} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{K(t.id).then(()=>{u()})})}return(t,e)=>{const o=D("el-button"),h=D("el-tag"),x=D("el-card");return T(),N(x,{class:"factory-card"},{default:s(()=>[B("div",null,[B("div",O,[e[4]||(e[4]=B("h1",null,"工厂资料",-1)),i(o,{type:"primary",onClick:V},{default:s(()=>e[3]||(e[3]=[v("添加工厂")])),_:1,__:[3]})]),i(U,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),fields:w,onSearch:$,onReset:k},null,8,["modelValue"]),i(j,{goods:f.value,columns:F,onEdit:_,onDelete:g},{actions:s(({row:a,$index:X})=>[i(o,{type:"primary",size:"small",onClick:S=>_(a)},{default:s(()=>e[5]||(e[5]=[v("编辑")])),_:2,__:[5]},1032,["onClick"]),i(o,{type:"danger",size:"small",onClick:S=>g(a)},{default:s(()=>e[6]||(e[6]=[v("删除")])),_:2,__:[6]},1032,["onClick"])]),status:s(({row:a})=>[i(h,{type:a.status==="active"?"success":"info"},{default:s(()=>[v(z(l[a.status]),1)]),_:2},1032,["type"])]),_:1},8,["goods"]),i(L,{modelValue:d.value,"onUpdate:modelValue":[e[1]||(e[1]=a=>d.value=a),e[2]||(e[2]=a=>{a||y()})],title:m.value?"编辑工厂":"添加工厂",fields:C,formData:b.value,onSubmit:E},null,8,["modelValue","title","formData"])])]),_:1})}}}),ae=R(P,[["__scopeId","data-v-92337428"]]);export{ae as default};

import{d as E,r as i,a as S,o as I,G as N,D as s,g as _,z as $,A as y,C as o,E as c,B as M,R as T,_ as Y}from"./BxW7P6YO.js";import{B as q,a as z}from"./DmTcGZZt.js";import{B as R}from"./DTLkWoKO.js";import{g as U,u as W,a as j,d as G}from"./CoxSq_4e.js";const L={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-bottom":"16px"}},H=E({__name:"index",setup(J){const r=i({id:"",name:"",status:"",registeredAt:""}),D=[{prop:"id",label:"客户ID",placeholder:"请输入客户ID",type:"input"},{prop:"name",label:"姓名",placeholder:"请输入姓名",type:"input"},{prop:"status",label:"状态",type:"select",placeholder:"请选择状态",options:[{label:"全部",value:""},{label:"正常",value:"正常"},{label:"禁用",value:"禁用"}]},{prop:"registeredAt",label:"注册时间",type:"date",placeholder:"请选择注册时间",valueFormat:"YYYY-MM-DD"}],n=i(!1),u=i(!1),m=i({name:"",phone:"",address:"",status:"正常",registeredAt:"",_id:void 0}),x=[{prop:"name",label:"姓名",type:"input",placeholder:"请输入姓名",rules:[{required:!0,message:"必填"}]},{prop:"phone",label:"联系方式",type:"input",placeholder:"请输入手机号",rules:[{required:!0,message:"必填"}]},{prop:"address",label:"地址",type:"input",placeholder:"请输入地址"},{prop:"registeredAt",label:"注册时间",type:"date",placeholder:"请选择注册时间"},{prop:"status",label:"状态",type:"select",placeholder:"请选择状态",options:[{label:"正常",value:"正常"},{label:"禁用",value:"禁用"}],rules:[{required:!0,message:"必填"}]}],C=[{prop:"id",label:"客户ID",width:200},{prop:"name",label:"姓名",width:120},{prop:"phone",label:"联系方式",width:140},{prop:"address",label:"地址",width:200},{prop:"status",label:"状态",width:100,slot:!0},{prop:"createdAt",label:"创建时间",width:160},{prop:"updatedAt",label:"更新时间",width:160},{prop:"actions",label:"操作",minWidth:180,slot:!0,getActions:(e,t)=>[{label:"编辑",type:"primary",onClick:l=>g(l)},{label:"删除",type:"danger",onClick:l=>v(l)}]}],p=i([]),{$axios:K}=S();I(d);async function d(){const e=await U(r.value);p.value=e.data.data||e}function A(e){d().then(()=>{p.value=p.value.filter(t=>{const l=!e.id||t.id.includes(e.id),b=!e.name||t.name.includes(e.name),h=!e.status||t.status===e.status,a=!e.registeredAt||t.registeredAt.startsWith(e.registeredAt);return l&&b&&h&&a})})}function B(){r.value={id:"",name:"",status:"",registeredAt:""},d()}function w(){u.value=!1,f(),n.value=!0}function k(e){u.value=!0,m.value={...e,_id:e.id},n.value=!0}function f(){m.value={name:"",phone:"",address:"",status:"正常",registeredAt:"",_id:void 0}}async function V(e){const t={...e};delete t._id,u.value?await W(e._id,t):await j(t),d(),n.value=!1,f()}function g(e){k(e)}function v(e){T.confirm(`确定要删除客户：${e.name} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{G(e.id).then(()=>{d()})})}return(e,t)=>{const l=_("el-button"),b=_("el-tag"),h=_("el-card");return $(),N(h,{class:"customer-card"},{default:s(()=>[y("div",null,[y("div",L,[t[4]||(t[4]=y("h1",null,"客户管理",-1)),o(l,{type:"primary",onClick:w},{default:s(()=>t[3]||(t[3]=[c("添加客户")])),_:1,__:[3]})]),o(q,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=a=>r.value=a),fields:D,onSearch:A,onReset:B},null,8,["modelValue"]),o(z,{goods:p.value,columns:C,onEdit:g,onDelete:v},{actions:s(({row:a,$index:O})=>[o(l,{type:"primary",size:"small",onClick:F=>g(a)},{default:s(()=>t[5]||(t[5]=[c("编辑")])),_:2,__:[5]},1032,["onClick"]),o(l,{type:"danger",size:"small",onClick:F=>v(a)},{default:s(()=>t[6]||(t[6]=[c("删除")])),_:2,__:[6]},1032,["onClick"])]),status:s(({row:a})=>[o(b,{type:a.status==="正常"?"success":"info"},{default:s(()=>[c(M(a.status),1)]),_:2},1032,["type"])]),_:1},8,["goods"]),o(R,{modelValue:n.value,"onUpdate:modelValue":[t[1]||(t[1]=a=>n.value=a),t[2]||(t[2]=a=>{a||f()})],title:u.value?"编辑客户":"添加客户",fields:x,formData:m.value,onSubmit:V},null,8,["modelValue","title","formData"])])]),_:1})}}}),ee=Y(H,[["__scopeId","data-v-3d5c456a"]]);export{ee as default};
